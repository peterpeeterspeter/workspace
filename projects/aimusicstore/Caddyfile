# Caddyfile for aimusicstore.com
# Frontend: React app (static files)
# Backend: FastAPI (proxied)

aimusicstore.com,
www.aimusicstore.com,
23.95.148.204 {
	root * /var/www/aimusicstore
	file_server browse

	# API endpoints - proxy to FastAPI
	handle /api/* {
		reverse_proxy 127.0.0.1:8000
	}

	# Health check endpoint
	handle /health {
		reverse_proxy 127.0.0.1:8000
	}

	# API documentation
	handle /docs {
		reverse_proxy 127.0.0.1:8000
	}

	# OpenAPI spec
	handle /openapi.json {
		reverse_proxy 127.0.0.1:8000
	}

	# Security headers
	header {
		X-Frame-Options "SAMEORIGIN"
		X-Content-Type-Options "nosniff"
		X-XSS-Protection "1; mode=block"
		-Server
	}

	# Enable gzip compression
	encode {
		gzip
	}
}
